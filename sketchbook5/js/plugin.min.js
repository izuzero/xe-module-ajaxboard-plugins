/*! Copyright (C) 2014 AJAXBOARD. All rights reserved. */!function(e,t){"use strict";function n(e){return m.ajax("html",m.current_url,null,null,e)}function r(){t(".simple_wrt").each(function(){var e=t(this),n=e.find("textarea[id*='editor_']").val();e.parent().children("input[name='content']").val(n)}),board("#bd_"+m.module_srl+"_"+(m.document_srl||0))}function i(e){if(!t("#cmtPosition").length)return!1;if(u)return t(".fdb_lst_ul").append(t("#cmt_alert").show()),!1;var i=n(e).done(function(e){t.cookie("socialxe_content",t(".cmt_wrt textarea").val());var n=t("<div>").append(t.parseHTML(e)).find("#cmtPosition");t(".cmt_editor").append(t("#re_cmt").hide()),t("body").append(t("#cmt_alert").hide()),t("#cmtPosition").html(n.html()),r()});return i}function o(e){u=!1;var t=i({cpage:e});return t&&t.done(function(){m.current_url=m.current_url.setQuery("cpage",e),m.scrolling(1,SLIDE_DURATION,"#cmtPosition")}),t}function c(e){var i=n(e).done(function(e){t.cookie("socialxe_content",t(".cmt_wrt textarea").val());var n=t("<div>").append(t.parseHTML(e)).find(".bd_lst_wrp"),i=t(".bd_lst_wrp");i.find(l).html(n.find(l).html()),i.find(".bd_pg").html(n.find(".bd_pg").html()),t("#cmtPosition .cmt_pg").remove(),r()});return i}function a(e){var t=c({page:e}).done(function(){m.current_url=m.current_url.setQuery("page",e)});return t}var l,u=!1,m=e.ajaxboard;t(function(){var n=t(".bd").attr("data-default_style"),r=["list","webzine","gallery","cloud_gall","faq"],d=["table.bd_tb_lst","ol.bd_zine","ol.bd_tmb_lst","ul.bd_cloud","ul.bd_faq"];if(n&&t.inArray(n,r)>-1){l=d[t.inArray(n,r)];var s=e.reComment;s&&t.isFunction(s)&&(e.reComment=function(e,t,n){u=!0,s(e,t,n)});var _=e.doCallModuleAction;if(_&&t.isFunction(_)){var f=function(e){"success"!==e.message&&alert(e.message)};e.doCallModuleAction=function(e,n,r){var i=["procDocumentVoteUp","procDocumentVoteDown","procDocumentDeclare","procCommentVoteUp","procCommentVoteDown","procCommentDeclare"];if(t.inArray(n,i)>-1){var o={target_srl:r,cur_mid:m.current_mid,mid:m.current_mid};return exec_xml(e,n,o,f)}return t.isFunction(_)?_(e,n,r):void 0}}var p=e.completeInsertComment;p&&t.isFunction(p)&&(e.completeInsertComment=function(){m.clearEditor()}),t("#cmtPosition").on("click",".fdb_nav [href]",function(){var e=t(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var n=e.getQuery("act"),r=e.getQuery("comment_srl");return r&&"dispBoardDeleteComment"==n?(m.deleteComment(r,e,function(e){alert(e.message)},function(){i()}),!1):void 0}).on("click",".bd_pg [href], .cmt_pg [href]",function(){var e=t(this),n=e.attr("href");n.indexOf("#")>-1&&(n=n.substring(0,n.indexOf("#")));var r=n.getQuery("cpage");return r?(o(r>1&&e.hasClass("direction")?"":r),!1):void 0}),t("#re_cmt .close").on("click",function(){u=!1,t("#re_cmt").hide(),i()}),t("#re_cmt input[type='submit']").on("click",function(){u=!1,t("#re_cmt").hide()}),t(".bd_lst_wrp").on("click",".bd_pg [href]",function(){var e=t(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var n=e.getQuery("page");return a(n||1),!1}),m.insertTrigger("clearEditor","after",function(){t(".simple_wrt textarea[id*='editor_']").val("")}),m.insertTrigger("events.insertDocument","before",function(){c()}),m.insertTrigger("events.voteDocument","before",function(e){var n=e.extra_vars.point;m.document_srl==e.target_srl&&n>0?t(".rd_vote").children().eq(0).children().eq(0).html("♥ "+n):t(".rd_vote").children().eq(1).children().eq(0).html("♥ "+n)}),m.insertTrigger("events.insertComment","before",function(e){(t("#comment_"+e.parent_srl).length||t("#"+e.parent_srl+"_comment").length)&&i()}),m.insertTrigger("events.deleteComment","before",function(e){t("#comment_"+e.target_srl).length&&i()}),m.insertTrigger("events.voteComment","before",function(e){!u&&t("#comment_"+e.target_srl).length&&i()})}})}(this,jQuery);
