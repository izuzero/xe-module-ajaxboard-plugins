/*! Copyright (C) 2014 AJAXBOARD. All rights reserved. */!function(e,t){"use strict";function r(e){return a.ajax("html",a.current_url,null,null,e)}function n(e){if(!t("#cmtPosition").length)return!1;if(u)return t(".fdb_lst_ul").append(t("#cmt_alert").show()),!1;var n=r(e).done(function(e){var r=t("<div>").append(t.parseHTML(e)).find("#cmtPosition");t(".cmt_editor").append(t("#re_cmt").hide()),t("body").append(t("#cmt_alert").hide()),t("#cmtPosition").html(r.html()),board("#bd_"+a.module_srl+"_"+(a.document_srl||0))});return n}function i(e){u=!1;var t=n({cpage:e});return t&&t.done(function(){a.current_url=a.current_url.setQuery("cpage",e),a.scrolling(1,SLIDE_DURATION,"#cmtPosition")}),t}function o(e){var n=r(e).done(function(e){var r=t("<div>").append(t.parseHTML(e)).find(".bd .bd_lst_wrp"),n=t(".bd .bd_lst_wrp");n.find(l).html(r.find(l).html()),n.find(".bd_pg").html(r.find(".bd_pg").html()),t("#cmtPosition .cmt_pg").remove(),board("#bd_"+a.module_srl+"_"+(a.document_srl||0))});return n}function c(e){var t=o({page:e}).done(function(){a.current_url=a.current_url.setQuery("page",e)});return t}var l,u=!1,a=e.ajaxboard;t(function(){var r=t(".bd").attr("data-default_style"),d=["list","webzine","gallery","cloud_gall","faq"],m=["table.bd_tb_lst","ol.bd_zine","ol.bd_tmb_lst","ul.bd_cloud","ul.bd_faq"];if(r&&t.inArray(r,d)>-1){l=m[t.inArray(r,d)];var s=!1;a.insertTrigger("clearEditor","after",function(){t(".simple_wrt textarea[id*='editor_']").val("")}),a.insertTrigger("events.connect","after",function(){if(!s){s=!0;var r=e.reComment;r&&t.isFunction(r)&&(e.reComment=function(e,t,n){u=!0,r(e,t,n)});var o=e.doCallModuleAction;if(o&&t.isFunction(o)){var l=function(e){"success"!==e.message&&alert(e.message)};e.doCallModuleAction=function(e,r,n){var i=["procDocumentVoteUp","procDocumentVoteDown","procDocumentDeclare","procCommentVoteUp","procCommentVoteDown","procCommentDeclare"];if(t.inArray(r,i)>-1){var c={target_srl:n,cur_mid:a.current_mid,mid:a.current_mid};return exec_xml(e,r,c,l)}return t.isFunction(o)?o(e,r,n):void 0}}var d=e.completeInsertComment;d&&t.isFunction(d)&&(e.completeInsertComment=function(){a.clearEditor()}),t("#cmtPosition").on("click",".fdb_nav [href]",function(){var e=t(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var r=e.getQuery("act"),i=e.getQuery("comment_srl");return i&&"dispBoardDeleteComment"==r?(a.deleteComment(i,e,function(e){alert(e.message)},function(){n()}),!1):void 0}).on("click",".bd_pg [href], .cmt_pg [href]",function(){var e=t(this),r=e.attr("href");r.indexOf("#")>-1&&(r=r.substring(0,r.indexOf("#")));var n=r.getQuery("cpage");return n?(i(n>1&&e.hasClass("direction")?"":n),!1):void 0}),t("#re_cmt .close").on("click",function(){u=!1,t("#re_cmt").hide(),n()}),t("#re_cmt input[type='submit']").on("click",function(){u=!1,t("#re_cmt").hide()}),t(".bd_lst_wrp").on("click",".bd_pg [href]",function(){var e=t(this).attr("href");e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#")));var r=e.getQuery("page");return c(r||1),!1})}}),a.insertTrigger("events.insertDocument","before",function(){o()}),a.insertTrigger("events.voteDocument","before",function(e){var r=e.extra_vars.point;a.document_srl==e.target_srl&&r>0?t(".rd_vote").children().eq(0).children().eq(0).html("♥ "+r):t(".rd_vote").children().eq(1).children().eq(0).html("♥ "+r)}),a.insertTrigger("events.insertComment","before",function(e){(t("#comment_"+e.parent_srl).length||t("#"+e.parent_srl+"_comment").length)&&n()}),a.insertTrigger("events.deleteComment","before",function(e){t("#comment_"+e.target_srl).length&&n()}),a.insertTrigger("events.voteComment","before",function(e){!u&&t("#comment_"+e.target_srl).length&&n()})}})}(this,jQuery);
